{"ast":null,"code":"import _initializerDefineProperty from \"/Users/home/Desktop/College/Fall 2022/CS_4620/cs4620-final-project/node_modules/@babel/runtime/helpers/esm/initializerDefineProperty.js\";\nimport _applyDecoratedDescriptor from \"/Users/home/Desktop/College/Fall 2022/CS_4620/cs4620-final-project/node_modules/@babel/runtime/helpers/esm/applyDecoratedDescriptor.js\";\nimport _initializerWarningHelper from \"/Users/home/Desktop/College/Fall 2022/CS_4620/cs4620-final-project/node_modules/@babel/runtime/helpers/esm/initializerWarningHelper.js\";\nvar _dec, _class, _class2, _descriptor;\nimport { ANodeModel3D } from \"../../nodeModel\";\nimport { AObjectState, ASerializable } from \"../../../base\";\nimport { NodeTransform3D } from \"../../../math\";\nimport { AObject3DModelWrapper } from \"../../../geometry\";\nimport * as THREE from \"three\";\nexport let ALoadedModel = (_dec = ASerializable(\"ALoadedModel\"), _dec(_class = (_class2 = class ALoadedModel extends ANodeModel3D {\n  get sourceScale() {\n    return this.sourceTransform.scale;\n  }\n  set sourceScale(v) {\n    this.sourceTransform.scale = v;\n  }\n  get verts() {\n    return this.geometry.verts;\n  }\n  set verts(v) {\n    this.geometry.verts = v;\n  }\n  constructor(obj, material) {\n    let sourceScale = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n    super();\n    _initializerDefineProperty(this, \"sourceTransform\", _descriptor, this);\n    this.loadedObjects = [];\n    let object = obj;\n    this.sourceTransform = new NodeTransform3D();\n    if (material) {\n      this.setMaterial(material);\n    }\n    if (obj instanceof THREE.BufferGeometry) {\n      if (obj.attributes.normal == undefined) {\n        obj.computeVertexNormals();\n      }\n      let threemesh = new THREE.Mesh(obj, this.material.threejs);\n      object = new AObject3DModelWrapper(threemesh);\n    } else if (obj instanceof THREE.Mesh || obj instanceof THREE.Group) {\n      object = new AObject3DModelWrapper(obj);\n    } else if (obj instanceof AObject3DModelWrapper) {\n      object = obj;\n    } else {\n      throw new Error(`Unrecognized loaded object ${obj} of type ${typeof obj}`);\n    }\n    this.addLoadedObject(object);\n    this.sourceScale = sourceScale;\n    const self = this;\n    this.subscribe(this.addStateKeyListener('sourceTransform', () => {\n      self.geometry.sourceTransform = self.sourceTransform;\n    }), 'loadedmodel.sourceTransform');\n  }\n  addLoadedObject(object) {\n    this.geometry.addMember(object);\n    this.loadedObjects.push(object);\n  }\n}, (_descriptor = _applyDecoratedDescriptor(_class2.prototype, \"sourceTransform\", [AObjectState], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n})), _class2)) || _class);","map":{"version":3,"names":["ANodeModel3D","AObjectState","ASerializable","NodeTransform3D","AObject3DModelWrapper","THREE","ALoadedModel","sourceScale","sourceTransform","scale","v","verts","geometry","constructor","obj","material","loadedObjects","object","setMaterial","BufferGeometry","attributes","normal","undefined","computeVertexNormals","threemesh","Mesh","threejs","Group","Error","addLoadedObject","self","subscribe","addStateKeyListener","addMember","push"],"sources":["/Users/home/Desktop/College/Fall 2022/CS_4620/cs4620-final-project/src/anigraph/scene/nodes/loaded/ALoadedModel.ts"],"sourcesContent":["import {ANodeModel3D} from \"../../nodeModel\";\nimport {AObjectState, ASerializable} from \"../../../base\";\nimport {NodeTransform3D, Vec3} from \"../../../math\";\nimport {AObject3DModelWrapper, VertexArray3D} from \"../../../geometry\";\nimport * as THREE from \"three\";\nimport {Loader} from \"three\";\nimport {OBJLoader} from \"three/examples/jsm/loaders/OBJLoader\";\nimport {PLYLoader} from \"three/examples/jsm/loaders/PLYLoader\";\nimport {AMaterial} from \"../../../rendering\";\n\n@ASerializable(\"ALoadedModel\")\nexport class ALoadedModel extends ANodeModel3D{\n    @AObjectState sourceTransform:NodeTransform3D;\n    get sourceScale(){\n        return this.sourceTransform.scale\n    }\n    set sourceScale(v:number|Vec3){\n        this.sourceTransform.scale=v;\n    }\n\n    get verts(){return this.geometry.verts as VertexArray3D;}\n    set verts(v:VertexArray3D){this.geometry.verts = v;}\n    loadedObjects:AObject3DModelWrapper[]=[];\n\n    constructor(obj:THREE.Object3D|AObject3DModelWrapper, material?:AMaterial, sourceScale:number=1) {\n        super();\n        let object = obj;\n        this.sourceTransform = new NodeTransform3D();\n        if(material){\n            this.setMaterial(material);\n        }\n        if(obj instanceof THREE.BufferGeometry) {\n            if(obj.attributes.normal == undefined){\n                obj.computeVertexNormals()\n            }\n            let threemesh = new THREE.Mesh(\n                obj,\n                this.material.threejs\n            );\n            object = new AObject3DModelWrapper(threemesh);\n        }else if(obj instanceof THREE.Mesh || obj instanceof THREE.Group){\n            object = new AObject3DModelWrapper(obj);\n        }else if (obj instanceof AObject3DModelWrapper) {\n            object = obj;\n        }else{\n            throw new Error(`Unrecognized loaded object ${obj} of type ${typeof obj}`);\n        }\n        this.addLoadedObject(object);\n        this.sourceScale=sourceScale;\n        const self = this;\n        this.subscribe(this.addStateKeyListener('sourceTransform', ()=>{\n            self.geometry.sourceTransform = self.sourceTransform;\n        }), 'loadedmodel.sourceTransform');\n    }\n\n    addLoadedObject(object:AObject3DModelWrapper){\n        this.geometry.addMember(object);\n        this.loadedObjects.push(object);\n    }\n\n\n\n}\n"],"mappings":";;;;AAAA,SAAQA,YAAY,QAAO,iBAAiB;AAC5C,SAAQC,YAAY,EAAEC,aAAa,QAAO,eAAe;AACzD,SAAQC,eAAe,QAAa,eAAe;AACnD,SAAQC,qBAAqB,QAAsB,mBAAmB;AACtE,OAAO,KAAKC,KAAK,MAAM,OAAO;AAM9B,WACaC,YAAY,WADxBJ,aAAa,CAAC,cAAc,CAAC,2BAA9B,MACaI,YAAY,SAASN,YAAY;EAE1C,IAAIO,WAAW,GAAE;IACb,OAAO,IAAI,CAACC,eAAe,CAACC,KAAK;EACrC;EACA,IAAIF,WAAW,CAACG,CAAa,EAAC;IAC1B,IAAI,CAACF,eAAe,CAACC,KAAK,GAACC,CAAC;EAChC;EAEA,IAAIC,KAAK,GAAE;IAAC,OAAO,IAAI,CAACC,QAAQ,CAACD,KAAK;EAAkB;EACxD,IAAIA,KAAK,CAACD,CAAe,EAAC;IAAC,IAAI,CAACE,QAAQ,CAACD,KAAK,GAAGD,CAAC;EAAC;EAGnDG,WAAW,CAACC,GAAwC,EAAEC,QAAmB,EAAwB;IAAA,IAAtBR,WAAkB,uEAAC,CAAC;IAC3F,KAAK,EAAE;IAAC;IAAA,KAHZS,aAAa,GAAyB,EAAE;IAIpC,IAAIC,MAAM,GAAGH,GAAG;IAChB,IAAI,CAACN,eAAe,GAAG,IAAIL,eAAe,EAAE;IAC5C,IAAGY,QAAQ,EAAC;MACR,IAAI,CAACG,WAAW,CAACH,QAAQ,CAAC;IAC9B;IACA,IAAGD,GAAG,YAAYT,KAAK,CAACc,cAAc,EAAE;MACpC,IAAGL,GAAG,CAACM,UAAU,CAACC,MAAM,IAAIC,SAAS,EAAC;QAClCR,GAAG,CAACS,oBAAoB,EAAE;MAC9B;MACA,IAAIC,SAAS,GAAG,IAAInB,KAAK,CAACoB,IAAI,CAC1BX,GAAG,EACH,IAAI,CAACC,QAAQ,CAACW,OAAO,CACxB;MACDT,MAAM,GAAG,IAAIb,qBAAqB,CAACoB,SAAS,CAAC;IACjD,CAAC,MAAK,IAAGV,GAAG,YAAYT,KAAK,CAACoB,IAAI,IAAIX,GAAG,YAAYT,KAAK,CAACsB,KAAK,EAAC;MAC7DV,MAAM,GAAG,IAAIb,qBAAqB,CAACU,GAAG,CAAC;IAC3C,CAAC,MAAK,IAAIA,GAAG,YAAYV,qBAAqB,EAAE;MAC5Ca,MAAM,GAAGH,GAAG;IAChB,CAAC,MAAI;MACD,MAAM,IAAIc,KAAK,CAAE,8BAA6Bd,GAAI,YAAW,OAAOA,GAAI,EAAC,CAAC;IAC9E;IACA,IAAI,CAACe,eAAe,CAACZ,MAAM,CAAC;IAC5B,IAAI,CAACV,WAAW,GAACA,WAAW;IAC5B,MAAMuB,IAAI,GAAG,IAAI;IACjB,IAAI,CAACC,SAAS,CAAC,IAAI,CAACC,mBAAmB,CAAC,iBAAiB,EAAE,MAAI;MAC3DF,IAAI,CAAClB,QAAQ,CAACJ,eAAe,GAAGsB,IAAI,CAACtB,eAAe;IACxD,CAAC,CAAC,EAAE,6BAA6B,CAAC;EACtC;EAEAqB,eAAe,CAACZ,MAA4B,EAAC;IACzC,IAAI,CAACL,QAAQ,CAACqB,SAAS,CAAChB,MAAM,CAAC;IAC/B,IAAI,CAACD,aAAa,CAACkB,IAAI,CAACjB,MAAM,CAAC;EACnC;AAIJ,CAAC,kFAlDIhB,YAAY;EAAA;EAAA;EAAA;EAAA;AAAA"},"metadata":{},"sourceType":"module"}