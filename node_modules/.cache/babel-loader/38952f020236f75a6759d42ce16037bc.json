{"ast":null,"code":"/**\n * @file Main scene model\n * @description Scene model for your application\n */\n\nimport { ACameraModel, Color, GetAppState, NodeTransform3D, V3, Vec2, Vec3 } from \"../../../anigraph\";\nimport { BaseSceneModel } from \"../../BaseClasses\";\nimport { ATexture } from \"src/anigraph/rendering/ATexture\";\nimport { APointLightModel } from \"../../../anigraph/scene/lights\";\nimport { AppConfigs } from \"../../AppConfigs\";\nimport { PlayerModel } from \"../Nodes/PlayerNode\";\nimport { GameTerrainModel } from \"../Nodes/GameTerrain/GameTerrainModel\";\nimport { BillboardParticleSystemModel } from \"../Nodes/BillboardParticleSystem\";\nimport { EMPTY_LEVEL } from \"../../Backend/DefaultLevels\";\nlet appState = GetAppState();\nvar MyMaterialNames;\n(function (MyMaterialNames) {\n  MyMaterialNames[\"basicshader1\"] = \"basicshader1\";\n  MyMaterialNames[\"mymaterial2\"] = \"mymaterial2\";\n})(MyMaterialNames || (MyMaterialNames = {}));\nexport class MainSceneModel extends BaseSceneModel {\n  constructor() {\n    super(...arguments);\n    this.playerTexture = void 0;\n    this.bots = [];\n    this.gameTerrains = {};\n    this.lastTerrains = [];\n    this.currentLevel = EMPTY_LEVEL;\n    this.passedCheckpoints = 0;\n    this.lastT = void 0;\n    this.billboardParticles = [];\n    this._player = void 0;\n    this._mesh = void 0;\n  }\n  get player() {\n    return this._player;\n  }\n  set player(v) {\n    this._player = v;\n  }\n  get mesh() {\n    return this._mesh;\n  }\n  set mesh(v) {\n    this._mesh = v;\n  }\n  async PreloadAssets() {\n    await super.PreloadAssets();\n    await GameTerrainModel.LoadShader();\n    await PlayerModel.LoadShader();\n    // this.materials.setMaterialModel(\"textured\", await ABasicShaderModel.CreateModel(\"basic\"));\n  }\n\n  initCamera() {\n    this.cameraModel = ACameraModel.CreatePerspectiveFOV(90, 1, 0.01, 10);\n    this.cameraModel.setPose(NodeTransform3D.LookAt(V3(0.0, 0, 5), V3(0, 0, 0), V3(0, 1, 0)));\n  }\n\n  /**\n   * The view light is a light that is attached to the camera.\n   */\n  initViewLight() {\n    if (this.viewLight) return;\n\n    /**\n     * Create a point light\n     * You can have up to 16 point lights in the scene at once by default\n     */\n    this.viewLight = new APointLightModel(this.camera.pose, Color.FromString(\"#ffffff\"), 0.5, AppConfigs.ViewLightRange, 1);\n\n    /**\n     * Add it as a child of the camera model so that it will move with the camera\n     */\n    this.cameraModel.addChild(this.viewLight);\n  }\n  async initGameTerrain() {\n    if (this.lastTerrains == this.gameTerrains[this.currentLevel.name]) return;\n    for (let t of this.lastTerrains) {\n      t.position.y -= 500;\n    }\n    if (this.gameTerrains[this.currentLevel.name]) {\n      this.lastTerrains = this.gameTerrains[this.currentLevel.name];\n      for (let t of this.lastTerrains) {\n        t.position.y += 500;\n      }\n    } else {\n      const t = [];\n      for (let [x1, y1, w, h] of this.currentLevel.terrains) {\n        let terrain = await GameTerrainModel.Create(w, h);\n        terrain.position.x = x1 + w / 2;\n        terrain.position.y = y1 + h / 2;\n        t.push(terrain);\n        this.addChild(terrain);\n      }\n      this.gameTerrains[this.currentLevel.name] = t;\n      this.lastTerrains = t;\n    }\n  }\n  async initGameHero() {\n    if (!this.player) {\n      this.playerTexture = await ATexture.LoadAsync(\"./images/tanktexburngreen.jpeg\");\n      this.player = await PlayerModel.Create(this.playerTexture);\n      this.addChild(this.player);\n    }\n    this.player.position = new Vec3(...this.currentLevel.player, 0);\n  }\n  async initScene() {\n    await this.initGameTerrain();\n    await this.initGameHero();\n    await this.initParticles();\n    this.passedCheckpoints = 0;\n\n    /**\n     * Now let's initialize the view light\n     */\n    this.initViewLight();\n  }\n  async initParticles() {\n    // BillboardParticleSystemModel.AddParticleSystemControls();\n    const targetLength = this.currentLevel.fires.length;\n    for (let i = this.billboardParticles.length; i < targetLength; i++) {\n      const bp = new BillboardParticleSystemModel(new NodeTransform3D(V3(0, -100, 0)));\n      bp.setDisable();\n      this.billboardParticles.push(bp);\n    }\n    for (let i = 0, j = targetLength; i < j; i++) {\n      const bp = this.billboardParticles[i];\n      bp.myTransform.position = V3(this.currentLevel.fires[i][0] + .5, this.currentLevel.fires[i][1], 0);\n    }\n  }\n  async updateLevel(level) {\n    this.currentLevel = level;\n    await this.initScene();\n  }\n  timeUpdate(t) {\n    let paused = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    /**\n     * We can call timeUpdate on all of the model nodes in the scene here, which will trigger any updates that they\n     * individually define.\n     */\n    for (let c of this.getDescendantList()) {\n      c.timeUpdate(t);\n    }\n    if (!paused) {\n      this.player.update(t - this.lastT, this.gameTerrains[this.currentLevel.name] || []);\n      if (this.player.position.y < -10 || t <= 0.5) {\n        this.player.position = new Vec3(...(this.passedCheckpoints === 0 ? this.currentLevel.player : this.currentLevel.checkpoints[this.passedCheckpoints - 1][1]), 0);\n        this.player.velocity = new Vec3();\n        const playerPos = this.player.position;\n        const cameraPos = playerPos.clone();\n        cameraPos.z = 10;\n        this.cameraModel.setPose(NodeTransform3D.LookAt(cameraPos, playerPos, new Vec3(0, 1, 0)));\n      }\n      const playerUpper = this.player.position.y + this.player.size / 2;\n      const playerLower = this.player.position.y - this.player.size / 2;\n      const playerLeft = this.player.position.x - this.player.size / 2;\n      const playerRight = this.player.position.x + this.player.size / 2;\n      for (let i = 0, j = this.currentLevel.fires.length; i < j; i++) {\n        const [x, y] = this.currentLevel.fires[i];\n        const p = this.billboardParticles[i];\n        if (x < playerLeft - 10 || x > playerRight + 10 || y < playerLower - 10 || y > playerUpper + 10) {\n          if (!p.disabled) {\n            var _p$parent;\n            p.setDisable();\n            p.myTransform.position = V3(0, -999, 0);\n            (_p$parent = p.parent) === null || _p$parent === void 0 ? void 0 : _p$parent.removeChild(p);\n          }\n          continue;\n        } else {\n          if (p.disabled) {\n            p.disabled = false;\n            p.myTransform.position = V3(x + .5, y, 0);\n            this.addChild(p);\n          }\n        }\n        if ((playerLower < y + .8 && playerLower > y + .2 || playerUpper > y + .2 && playerUpper < y + .8 || playerLower < y + .2 && playerUpper > y + .8) && (playerLeft < x + .8 && playerLeft > x + .2 || playerRight > x + .2 && playerRight < x + .8 || playerLeft < x + .2 && playerRight > x + .8)) {\n          this.player.position = new Vec3(...(this.passedCheckpoints === 0 ? this.currentLevel.player : this.currentLevel.checkpoints[this.passedCheckpoints - 1][1]), 0);\n          this.player.velocity = new Vec3();\n        }\n      }\n      for (let i = this.passedCheckpoints, j = this.currentLevel.checkpoints.length; i < j; i++) {\n        if (Math.abs(this.player.velocity.y) < 0.01 && this.player.position.x >= this.currentLevel.checkpoints[i][0]) {\n          this.passedCheckpoints = Math.max(i + 1, this.passedCheckpoints);\n        }\n      }\n      if (Math.abs(this.cameraModel.pose.position.x - this.player.position.x) >= 0.01 || Math.abs(this.cameraModel.pose.position.y - this.player.position.y) >= 0.01) {\n        const cameraPos = this.cameraModel.pose.position.clone();\n        const playerPos = this.player.position.clone();\n        const playerVel = this.player.velocity.clone();\n        // higher gravity will look like player falling down harder\n        const g = AppConfigs.Gravity > 10 ? (AppConfigs.Gravity - 10) / 10 : 0;\n        playerVel.y = playerVel.y < g * playerVel.y ? 0 : playerVel.y;\n        // rate of camera movement, with 1 being camera on player at all times\n        const rate = this.cameraModel.pose.position.y < this.player.position.y ? 0.04 : 0.05;\n        // 1.5 is how much screen moves with player\n        const velocityCamera = cameraPos.clone().plus(playerVel.clone().times(1.5));\n        const new_camera_pos = velocityCamera.clone().plus(playerPos.clone().minus(velocityCamera).times(rate));\n        new_camera_pos.z = 10;\n        const new_target_pos = new_camera_pos.clone();\n        new_target_pos.z = 0;\n        this.cameraModel.setPose(NodeTransform3D.LookAt(new_camera_pos, new_target_pos, new Vec3(0, 1, 0)));\n      }\n      this.cameraModel.signalCameraProjectionUpdate();\n    }\n    this.lastT = t;\n\n    // /**\n    //  * For interactions between models, we can trigger logic here. For example, if you want characters to walk on\n    //  * uneven terrain, you can make that happen by completing the functions used here:\n    //  */\n    // const self = this;\n    // function adjustHeight(character:Particle3D){\n    //     let height = self.terrain.getTerrainHeightAtPoint(character.position.xy);\n    //     if(character.position.z<height){character.position.z = height;}\n    // }\n    //\n    // /**\n    //  * Here we would apply our adjust height function to the player\n    //  */\n    // adjustHeight(this.player);\n    //\n    // /**\n    //  * Now lets update bots\n    //  */\n    // let orbitradius = 0.25;\n    // for(let ei=0;ei<this.bots.length;ei++){\n    //     let e = this.bots[ei];\n    //\n    //     /**\n    //      * Characters have velocity and mass properties in case you want to implement particle physics\n    //      * But for now we will just have them orbit each other.\n    //      */\n    //     e.position = new Vec3(Math.cos(t*(ei+1)), Math.sin(t*(ei+1)),0).times(orbitradius);\n    //\n    //     /**\n    //      * adjust their height\n    //      */\n    //     adjustHeight(e);\n    // }\n  }\n\n  getCoordinatesForCursorEvent(event) {\n    var _event$ndcCursor;\n    return (_event$ndcCursor = event.ndcCursor) !== null && _event$ndcCursor !== void 0 ? _event$ndcCursor : new Vec2();\n  }\n}","map":{"version":3,"names":["ACameraModel","Color","GetAppState","NodeTransform3D","V3","Vec2","Vec3","BaseSceneModel","ATexture","APointLightModel","AppConfigs","PlayerModel","GameTerrainModel","BillboardParticleSystemModel","EMPTY_LEVEL","appState","MyMaterialNames","MainSceneModel","playerTexture","bots","gameTerrains","lastTerrains","currentLevel","passedCheckpoints","lastT","billboardParticles","_player","_mesh","player","v","mesh","PreloadAssets","LoadShader","initCamera","cameraModel","CreatePerspectiveFOV","setPose","LookAt","initViewLight","viewLight","camera","pose","FromString","ViewLightRange","addChild","initGameTerrain","name","t","position","y","x1","y1","w","h","terrains","terrain","Create","x","push","initGameHero","LoadAsync","initScene","initParticles","targetLength","fires","length","i","bp","setDisable","j","myTransform","updateLevel","level","timeUpdate","paused","c","getDescendantList","update","checkpoints","velocity","playerPos","cameraPos","clone","z","playerUpper","size","playerLower","playerLeft","playerRight","p","disabled","parent","removeChild","Math","abs","max","playerVel","g","Gravity","rate","velocityCamera","plus","times","new_camera_pos","minus","new_target_pos","signalCameraProjectionUpdate","getCoordinatesForCursorEvent","event","ndcCursor"],"sources":["/Users/home/Desktop/cs4620-final-project/src/app/main/Scene/MainSceneModel.ts"],"sourcesContent":["/**\n * @file Main scene model\n * @description Scene model for your application\n */\n\nimport {ACameraModel, AInteractionEvent, Color, GetAppState, NodeTransform3D, V3, Vec2, Vec3} from \"../../../anigraph\";\nimport {BaseSceneModel} from \"../../BaseClasses\";\nimport {ATexture} from \"src/anigraph/rendering/ATexture\";\nimport {APointLightModel} from \"../../../anigraph/scene/lights\";\nimport {AppConfigs} from \"../../AppConfigs\";\nimport {PlayerModel} from \"../Nodes/PlayerNode\";\nimport {BotModel} from \"../Nodes/CharacterNodes/BotModel\";\nimport {GameTerrainModel} from \"../Nodes/GameTerrain/GameTerrainModel\";\nimport {BillboardParticleSystemModel} from \"../Nodes/BillboardParticleSystem\";\nimport {LevelDefinition} from \"../../Backend/Level\";\nimport {EMPTY_LEVEL} from \"../../Backend/DefaultLevels\";\nimport playerBlock from \"../Editor/PlayerBlock\";\nimport { A3DModelLoader, AObject3DModelWrapper, AShaderMaterial } from \"../../../anigraph\";\nimport { CharacterModel, CharacterModelInterface } from \"../../BaseClasses\";\nimport { ExampleLoadedCharacterModel } from \"../Nodes/Loaded/ExampleLoadedCharacterModel\";\n//import { AddStandardUniforms } from \"../HowToAddUniformToControlPanel\";\nimport { LoadedCharacterModel } from \"src/app/BaseClasses/LoadedCharacterModel\";\nimport { ABasicShaderModel } from \"src/anigraph/rendering/shadermodels/ABasicShaderModel\";\n\nlet appState = GetAppState();\n\nenum MyMaterialNames {\n  basicshader1 = \"basicshader1\",\n  mymaterial2 = \"mymaterial2\",\n}\n\nexport class MainSceneModel extends BaseSceneModel {\n  playerTexture!: ATexture;\n  /**\n   * An array of bots. Your\n   */\n  bots: BotModel[] = [];\n  gameTerrains: { [name: string]: GameTerrainModel[] } = {};\n  lastTerrains: GameTerrainModel[] = [];\n  currentLevel: LevelDefinition = EMPTY_LEVEL;\n  passedCheckpoints: number = 0;\n  private lastT: number;\n  billboardParticles:BillboardParticleSystemModel[] = [];\n\n  /**\n   * Our custom player model, and a texture to use for our player\n   */\n  _player!: PlayerModel;\n\n  get player(): PlayerModel {\n    return this._player as PlayerModel;\n  }\n\n  set player(v: PlayerModel) {\n    this._player = v;\n  }\n\n  _mesh!: CharacterModelInterface;\n  get mesh(): CharacterModelInterface {\n    return this._mesh as LoadedCharacterModel;\n  }\n  set mesh(v: CharacterModelInterface) {\n    this._mesh = v;\n  }\n\n  async PreloadAssets() {\n    await super.PreloadAssets();\n    await GameTerrainModel.LoadShader();\n    await PlayerModel.LoadShader();\n    // this.materials.setMaterialModel(\"textured\", await ABasicShaderModel.CreateModel(\"basic\"));\n\n  }\n\n  initCamera() {\n    this.cameraModel = ACameraModel.CreatePerspectiveFOV(90, 1, 0.01, 10);\n    this.cameraModel.setPose(\n      NodeTransform3D.LookAt(\n        V3(0.0, 0, 5), V3(0, 0, 0),\n        V3(0, 1, 0)\n      )\n    )\n  }\n\n  /**\n   * The view light is a light that is attached to the camera.\n   */\n  initViewLight() {\n\n    if (this.viewLight) return;\n\n    /**\n     * Create a point light\n     * You can have up to 16 point lights in the scene at once by default\n     */\n    this.viewLight = new APointLightModel(\n      this.camera.pose,\n      Color.FromString(\"#ffffff\"),\n      0.5,\n      AppConfigs.ViewLightRange,\n      1\n    );\n\n    /**\n     * Add it as a child of the camera model so that it will move with the camera\n     */\n    this.cameraModel.addChild(this.viewLight);\n  }\n\n  async initGameTerrain() {\n    if (this.lastTerrains == this.gameTerrains[this.currentLevel.name])\n      return;\n    for (let t of this.lastTerrains) {\n      t.position.y -= 500;\n    }\n    if (this.gameTerrains[this.currentLevel.name]) {\n      this.lastTerrains = this.gameTerrains[this.currentLevel.name];\n      for (let t of this.lastTerrains) {\n        t.position.y += 500;\n      }\n    } else {\n      const t = [];\n      for (let [x1, y1, w, h] of this.currentLevel.terrains) {\n        let terrain = await GameTerrainModel.Create(w, h);\n        terrain.position.x = x1 + w / 2;\n        terrain.position.y = y1 + h / 2;\n        t.push(terrain);\n        this.addChild(terrain);\n      }\n      this.gameTerrains[this.currentLevel.name] = t;\n      this.lastTerrains = t;\n    }\n  }\n\n  async initGameHero() {\n    if (!this.player) {\n      this.playerTexture = await ATexture.LoadAsync(\"./images/tanktexburngreen.jpeg\")\n      this.player = await PlayerModel.Create(this.playerTexture);\n      this.addChild(this.player);\n    }\n    this.player.position = new Vec3(...this.currentLevel.player, 0);\n  }\n\n  async initScene() {\n    await this.initGameTerrain();\n    await this.initGameHero();\n    await this.initParticles();\n    this.passedCheckpoints = 0;\n\n    /**\n     * Now let's initialize the view light\n     */\n    this.initViewLight();\n  }\n\n    async initParticles() {\n        // BillboardParticleSystemModel.AddParticleSystemControls();\n      const targetLength = this.currentLevel.fires.length;\n      for (let i = this.billboardParticles.length; i < targetLength; i++) {\n        const bp = new BillboardParticleSystemModel(new NodeTransform3D(V3(0, -100, 0)));\n        bp.setDisable();\n        this.billboardParticles.push(bp);\n      }\n      for (let i = 0, j = targetLength; i < j; i++) {\n        const bp = this.billboardParticles[i];\n        bp.myTransform.position = V3(this.currentLevel.fires[i][0] + .5, this.currentLevel.fires[i][1], 0);\n      }\n    }\n\n  async updateLevel(level: LevelDefinition) {\n    this.currentLevel = level;\n    await this.initScene();\n  }\n\n    timeUpdate(t: number, paused: boolean = false, ...args:any[]) {\n      /**\n       * We can call timeUpdate on all of the model nodes in the scene here, which will trigger any updates that they\n       * individually define.\n       */\n      for (let c of this.getDescendantList()) {\n        c.timeUpdate(t);\n      }\n\n      if (!paused) {\n        this.player.update(t - this.lastT, this.gameTerrains[this.currentLevel.name] || []);\n\n        if (this.player.position.y < -10 || t <= 0.5) {\n          this.player.position = new Vec3(...(\n            this.passedCheckpoints === 0 ? this.currentLevel.player : this.currentLevel.checkpoints[this.passedCheckpoints - 1][1]\n          ), 0);\n          this.player.velocity = new Vec3();\n          const playerPos = this.player.position;\n          const cameraPos = playerPos.clone();\n          cameraPos.z = 10;\n          this.cameraModel.setPose(\n            NodeTransform3D.LookAt(\n              cameraPos, playerPos,\n              new Vec3(0, 1, 0)\n            )\n          );\n        }\n\n        const playerUpper = this.player.position.y + this.player.size / 2;\n        const playerLower = this.player.position.y - this.player.size / 2;\n        const playerLeft = this.player.position.x - this.player.size / 2;\n        const playerRight = this.player.position.x + this.player.size / 2;\n        for (let i = 0, j = this.currentLevel.fires.length; i < j; i++) {\n          const [x, y] = this.currentLevel.fires[i];\n          const p = this.billboardParticles[i];\n          if (x < playerLeft - 10 || x > playerRight + 10 || y < playerLower - 10 || y > playerUpper + 10) {\n            if (!p.disabled) {\n              p.setDisable();\n              p.myTransform.position = V3(0, -999, 0);\n              p.parent?.removeChild(p);\n            }\n            continue;\n          } else {\n            if (p.disabled) {\n              p.disabled = false;\n              p.myTransform.position = V3(x + .5, y, 0);\n              this.addChild(p);\n            }\n          }\n          if (((playerLower < y + .8 && playerLower > y + .2) ||\n            (playerUpper > y + .2 && playerUpper < y + .8) ||\n              (playerLower < y + .2 && playerUpper > y + .8)) &&\n            ((playerLeft < x + .8 && playerLeft > x + .2) ||\n              (playerRight > x + .2 && playerRight < x + .8) ||\n              (playerLeft < x + .2 && playerRight > x + .8))) {\n            this.player.position = new Vec3(...(\n              this.passedCheckpoints === 0 ? this.currentLevel.player : this.currentLevel.checkpoints[this.passedCheckpoints - 1][1]\n            ), 0);\n            this.player.velocity = new Vec3();\n          }\n        }\n\n        for (let i = this.passedCheckpoints, j = this.currentLevel.checkpoints.length; i < j; i++) {\n          if (Math.abs(this.player.velocity.y) < 0.01 && this.player.position.x >= this.currentLevel.checkpoints[i][0]) {\n            this.passedCheckpoints = Math.max(i + 1, this.passedCheckpoints);\n          }\n        }\n\n        if (Math.abs(this.cameraModel.pose.position.x - this.player.position.x) >= 0.01 ||\n          Math.abs(this.cameraModel.pose.position.y - this.player.position.y) >= 0.01) {\n\n          const cameraPos = this.cameraModel.pose.position.clone()\n          const playerPos = this.player.position.clone();\n          const playerVel = this.player.velocity.clone();\n          // higher gravity will look like player falling down harder\n          const g = AppConfigs.Gravity > 10 ? (AppConfigs.Gravity - 10) / 10 : 0\n          playerVel.y = playerVel.y < g * playerVel.y ? 0 : playerVel.y\n          // rate of camera movement, with 1 being camera on player at all times\n          const rate = (this.cameraModel.pose.position.y < this.player.position.y ? 0.04 : 0.05);\n          // 1.5 is how much screen moves with player\n          const velocityCamera = cameraPos.clone().plus(playerVel.clone().times(1.5))\n          const new_camera_pos = velocityCamera.clone().plus(playerPos.clone().minus(velocityCamera).times(rate))\n          new_camera_pos.z = 10;\n\n          const new_target_pos = new_camera_pos.clone()\n          new_target_pos.z = 0;\n\n          this.cameraModel.setPose(\n            NodeTransform3D.LookAt(\n              new_camera_pos, new_target_pos,\n              new Vec3(0, 1, 0)\n            )\n          );\n        }\n        this.cameraModel.signalCameraProjectionUpdate();\n      }\n\n      this.lastT = t;\n\n\n        // /**\n        //  * For interactions between models, we can trigger logic here. For example, if you want characters to walk on\n        //  * uneven terrain, you can make that happen by completing the functions used here:\n        //  */\n        // const self = this;\n        // function adjustHeight(character:Particle3D){\n        //     let height = self.terrain.getTerrainHeightAtPoint(character.position.xy);\n        //     if(character.position.z<height){character.position.z = height;}\n        // }\n        //\n        // /**\n        //  * Here we would apply our adjust height function to the player\n        //  */\n        // adjustHeight(this.player);\n        //\n        // /**\n        //  * Now lets update bots\n        //  */\n        // let orbitradius = 0.25;\n        // for(let ei=0;ei<this.bots.length;ei++){\n        //     let e = this.bots[ei];\n        //\n        //     /**\n        //      * Characters have velocity and mass properties in case you want to implement particle physics\n        //      * But for now we will just have them orbit each other.\n        //      */\n        //     e.position = new Vec3(Math.cos(t*(ei+1)), Math.sin(t*(ei+1)),0).times(orbitradius);\n        //\n        //     /**\n        //      * adjust their height\n        //      */\n        //     adjustHeight(e);\n        // }\n    }\n\n    getCoordinatesForCursorEvent(event: AInteractionEvent){\n        return event.ndcCursor??new Vec2();\n    }\n}\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}