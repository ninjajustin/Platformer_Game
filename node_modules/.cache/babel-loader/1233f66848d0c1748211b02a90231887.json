{"ast":null,"code":"import _initializerDefineProperty from \"/Users/home/Desktop/cs4620-final-project/node_modules/@babel/runtime/helpers/esm/initializerDefineProperty.js\";\nimport _applyDecoratedDescriptor from \"/Users/home/Desktop/cs4620-final-project/node_modules/@babel/runtime/helpers/esm/applyDecoratedDescriptor.js\";\nimport _initializerWarningHelper from \"/Users/home/Desktop/cs4620-final-project/node_modules/@babel/runtime/helpers/esm/initializerWarningHelper.js\";\nvar _class, _descriptor, _descriptor2, _dec, _class3, _class4, _descriptor3;\nimport * as THREE from \"three\";\nimport { ASerializable } from \"../../base/aserial\";\nimport { AObject, AObjectState } from \"../../base/aobject\";\nexport let ShaderManagerEnums;\n(function (ShaderManagerEnums) {\n  ShaderManagerEnums[\"SHADER_DIRECTORY_URL\"] = \"shaders/\";\n  ShaderManagerEnums[\"DEFAULT_SHADER\"] = \"basic\";\n})(ShaderManagerEnums || (ShaderManagerEnums = {}));\nexport let AShaderProgramSource = (_class = class AShaderProgramSource extends AObject {\n  constructor(name, vertexURL, fragURL) {\n    super();\n    this.name = void 0;\n    this.vertexURL = void 0;\n    this.fragURL = void 0;\n    _initializerDefineProperty(this, \"vertexSource\", _descriptor, this);\n    _initializerDefineProperty(this, \"fragSource\", _descriptor2, this);\n    this.sourcesLoadedPromise = void 0;\n    this.name = name;\n    this.vertexURL = vertexURL;\n    this.fragURL = fragURL;\n    const self = this;\n    async function loadSources() {\n      self.vertexSource = await AShaderProgramSource.LoadShaderFile(vertexURL);\n      self.fragSource = await AShaderProgramSource.LoadShaderFile(fragURL);\n      return self;\n    }\n    ;\n    this.sourcesLoadedPromise = loadSources();\n    // this.sourcesLoadedPromise = new Promise(function (myResolve, myReject){\n    //     self.vertexSource = (ShaderProgramSource.LoadShaderFile(vertexURL)) as string;\n    //     self.fragSource = (ShaderProgramSource.LoadShaderFile(fragURL)) as string;\n    //     myResolve();\n    // });\n    // this.sourcesLoadedPromise = loadSources();\n  }\n\n  static LoadShaderFile(sourceURL) {\n    let shaderLoader = new THREE.FileLoader();\n    let shaderSource = shaderLoader.loadAsync(sourceURL, function (xhr) {\n      console.log(xhr.loaded / xhr.total * 100 + '% loaded');\n    });\n    return shaderSource;\n  }\n}, (_descriptor = _applyDecoratedDescriptor(_class.prototype, \"vertexSource\", [AObjectState], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _descriptor2 = _applyDecoratedDescriptor(_class.prototype, \"fragSource\", [AObjectState], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n})), _class);\nlet AShaderSourceManager = (_dec = ASerializable(\"ShaderSourceManager\"), _dec(_class3 = (_class4 = class AShaderSourceManager extends AObject {\n  constructor() {\n    super();\n    _initializerDefineProperty(this, \"_shaderSources\", _descriptor3, this);\n    this._shaderPromises = {};\n    this._shaderSources = {};\n  }\n  static GetURLForShaderAtPath(path) {\n    return ShaderManagerEnums.SHADER_DIRECTORY_URL + path;\n  }\n  LoadShader(name, vertexPath, fragPath) {\n    let vPath = vertexPath !== null && vertexPath !== void 0 ? vertexPath : `${name}/${name}.vert.glsl`;\n    let fPath = fragPath !== null && fragPath !== void 0 ? fragPath : `${name}/${name}.frag.glsl`;\n    const self = this;\n    // this._shaderPromises[name]=new Promise<AShaderProgramSource>(function(myResolve, myReject){\n    //     let newSource =\n    //         new AShaderProgramSource(\n    //             name,\n    //             AShaderSourceManager.GetURLForShaderAtPath(vPath),\n    //             AShaderSourceManager.GetURLForShaderAtPath(fPath)\n    //         );\n    //     newSource.sourcesLoadedPromise.then(\n    //         function(value){\n    //             self._shaderSources[name]=value;\n    //         }\n    //     );\n    //     self._shaderSources[name]=newSource;\n    //     myResolve(newSource);\n    // })\n\n    let newSource = new AShaderProgramSource(name, AShaderSourceManager.GetURLForShaderAtPath(vPath), AShaderSourceManager.GetURLForShaderAtPath(fPath));\n    self._shaderSources[name] = newSource;\n    self._shaderPromises[name] = newSource.sourcesLoadedPromise;\n    return this._shaderPromises[name];\n    // assert(this._shaderSources[name] === undefined, `Tried to re-load shader ${name} with V:${vertexPath} F:${fragPath}`);\n  }\n\n  GetShaderSource(name) {\n    return this._shaderSources[name];\n  }\n}, (_descriptor3 = _applyDecoratedDescriptor(_class4.prototype, \"_shaderSources\", [AObjectState], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n})), _class4)) || _class3);\nexport const ShaderManager = new AShaderSourceManager();\n// ShaderManager.LoadShader('standard', 'standard/standard.vert.glsl', 'standard/standard.frag.glsl');\n// ShaderManager.LoadShader('textured', 'textured/textured.vert.glsl', 'textured/textured.frag.glsl');\n// ShaderManager.LoadShader('rgba', 'rgba/rgba.vert.glsl', 'rgba/rgba.frag.glsl');\n// ShaderManager.LoadShader('simple');\n\n// export {ShaderManager};","map":{"version":3,"names":["THREE","ASerializable","AObject","AObjectState","ShaderManagerEnums","AShaderProgramSource","constructor","name","vertexURL","fragURL","sourcesLoadedPromise","self","loadSources","vertexSource","LoadShaderFile","fragSource","sourceURL","shaderLoader","FileLoader","shaderSource","loadAsync","xhr","console","log","loaded","total","AShaderSourceManager","_shaderPromises","_shaderSources","GetURLForShaderAtPath","path","SHADER_DIRECTORY_URL","LoadShader","vertexPath","fragPath","vPath","fPath","newSource","GetShaderSource","ShaderManager"],"sources":["/Users/home/Desktop/cs4620-final-project/src/anigraph/rendering/material/ShaderManager.ts"],"sourcesContent":["import * as THREE from \"three\";\nimport {ASerializable} from \"../../base/aserial\";\nimport {AObject, AObjectState} from \"../../base/aobject\";\n\nexport enum ShaderManagerEnums{\n    SHADER_DIRECTORY_URL='shaders/',\n    DEFAULT_SHADER='basic'\n}\n\n\nexport class AShaderProgramSource extends AObject{\n    public name: string;\n    public vertexURL: string;\n    public fragURL: string;\n    @AObjectState vertexSource!: string;\n    @AObjectState fragSource!: string;\n    public sourcesLoadedPromise:Promise<this>;\n\n    constructor(name: string, vertexURL: string, fragURL: string) {\n        super();\n        this.name = name;\n        this.vertexURL = vertexURL;\n        this.fragURL = fragURL;\n        const self = this;\n        async function loadSources(){\n            self.vertexSource = (await AShaderProgramSource.LoadShaderFile(vertexURL)) as string;\n            self.fragSource = (await AShaderProgramSource.LoadShaderFile(fragURL)) as string;\n            return self;\n        };\n        this.sourcesLoadedPromise = loadSources();\n        // this.sourcesLoadedPromise = new Promise(function (myResolve, myReject){\n        //     self.vertexSource = (ShaderProgramSource.LoadShaderFile(vertexURL)) as string;\n        //     self.fragSource = (ShaderProgramSource.LoadShaderFile(fragURL)) as string;\n        //     myResolve();\n        // });\n        // this.sourcesLoadedPromise = loadSources();\n    }\n\n    static LoadShaderFile(sourceURL: string) {\n        let shaderLoader = new THREE.FileLoader();\n        let shaderSource = shaderLoader.loadAsync(\n            sourceURL,\n            function (xhr) {\n                console.log((xhr.loaded / xhr.total * 100) + '% loaded');\n            });\n        return shaderSource;\n    }\n}\n\nexport type ShaderPromise = Promise<AShaderProgramSource>;\n\n@ASerializable(\"ShaderSourceManager\")\nclass AShaderSourceManager extends AObject{\n    @AObjectState _shaderSources!:{[name:string]:AShaderProgramSource}\n    _shaderPromises:{[name:string]:Promise<AShaderProgramSource>}={};\n    constructor() {\n        super();\n        this._shaderSources={};\n    }\n\n    static GetURLForShaderAtPath(path:string){\n        return ShaderManagerEnums.SHADER_DIRECTORY_URL+path;\n    }\n\n    LoadShader(name:string, vertexPath?:string, fragPath?:string):ShaderPromise{\n        let vPath = vertexPath??`${name}/${name}.vert.glsl`\n        let fPath = fragPath??`${name}/${name}.frag.glsl`\n        const self=this;\n        // this._shaderPromises[name]=new Promise<AShaderProgramSource>(function(myResolve, myReject){\n        //     let newSource =\n        //         new AShaderProgramSource(\n        //             name,\n        //             AShaderSourceManager.GetURLForShaderAtPath(vPath),\n        //             AShaderSourceManager.GetURLForShaderAtPath(fPath)\n        //         );\n        //     newSource.sourcesLoadedPromise.then(\n        //         function(value){\n        //             self._shaderSources[name]=value;\n        //         }\n        //     );\n        //     self._shaderSources[name]=newSource;\n        //     myResolve(newSource);\n        // })\n\n        let newSource =\n            new AShaderProgramSource(\n                name,\n                AShaderSourceManager.GetURLForShaderAtPath(vPath),\n                AShaderSourceManager.GetURLForShaderAtPath(fPath)\n            );\n        self._shaderSources[name]=newSource;\n        self._shaderPromises[name]=newSource.sourcesLoadedPromise;\n        return this._shaderPromises[name];\n        // assert(this._shaderSources[name] === undefined, `Tried to re-load shader ${name} with V:${vertexPath} F:${fragPath}`);\n    }\n\n    GetShaderSource(name:string){\n        return this._shaderSources[name];\n    }\n}\n\n\nexport const ShaderManager = new AShaderSourceManager();\n// ShaderManager.LoadShader('standard', 'standard/standard.vert.glsl', 'standard/standard.frag.glsl');\n// ShaderManager.LoadShader('textured', 'textured/textured.vert.glsl', 'textured/textured.frag.glsl');\n// ShaderManager.LoadShader('rgba', 'rgba/rgba.vert.glsl', 'rgba/rgba.frag.glsl');\n// ShaderManager.LoadShader('simple');\n\n\n// export {ShaderManager};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}